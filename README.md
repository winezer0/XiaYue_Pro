# xiaYue_Pro - Burp Suite 越权检测插件

> **版本**: 2.3  
> **修改**: NOVASEC Team  
> **兼容性**: Burp Suite Professional 2020.1+

## 🚀 插件简介

xiaYue_Pro 是一款专为 Burp Suite 设计的越权漏洞检测插件，能够自动检测 Web 应用中的越权漏洞。插件通过对比不同权限级别下的响应差异，快速识别潜在的越权问题，为安全测试人员提供强大的自动化检测能力。

## ✨ 核心亮点功能

### 1. 🎯 智能越权检测
- **多权限对比**: 自动对比原始权限、低权限、无权限三种状态下的响应
- **智能去重**: 基于URL路径、HTTP方法和参数名的MD5去重，避免重复检测
- **响应长度分析**: 自动分析响应长度差异，快速识别权限控制失效

### 2. 🔍 高级过滤系统
- **HTTP方法过滤**: 支持批量过滤特定HTTP方法（如OPTIONS、HEAD等）
- **接口路径过滤**: 精确过滤指定接口路径，支持通配符匹配
- **白名单机制**: 灵活的白名单配置，支持多域名批量配置
- **静态资源过滤**: 自动过滤图片、CSS、JS等静态资源，提升检测效率

### 3. 🛠️ 参数替换引擎
- **智能参数替换**: 支持GET和POST请求的参数动态替换
- **多格式支持**: 兼容form-urlencoded、JSON等多种请求体格式
- **批量规则配置**: 支持多行参数替换规则，格式：`参数名=新值`

### 4. 📊 可视化数据展示
- **实时数据表格**: 清晰的表格展示，支持点击查看详细数据包
- **智能排序**: 支持按ID、方法、URL、响应长度等多列排序
- **差异标识**: 自动标识响应长度差异，用符号显示权限控制状态
  - `✔` 表示长度相同（可能存在越权）
  - `==>` 显示具体差异数值

### 5. 🔐 认证信息管理
- **低权限认证**: 配置低权限用户的认证信息（Cookie、Token等）
- **未授权配置**: 设置需要移除的认证字段
- **万能Cookie**: 支持通用Cookie配置，适用于多种场景
- **右键提取**: 右键菜单快速提取请求中的认证信息

### 6. 💾 配置持久化
- **自动保存**: 所有配置自动保存到本地文件
- **重启恢复**: 重启Burp Suite后自动恢复上次配置
- **快速配置**: 右键菜单提供快速配置对话框
- **配置迁移**: 支持配置文件的导入导出

### 7. ⚡ 性能优化
- **智能缓存**: 预分割过滤数组，避免重复字符串操作
- **异步处理**: 非阻塞式请求处理，不影响Burp Suite性能
- **内存管理**: 自动清理旧数据，防止内存溢出
- **调试优化**: 移除冗余日志输出，提升运行效率

## 🎨 界面特性

### 主界面布局
```
┌─────────────────────────────────────────────────────────────┐
│                    xiaYue_Pro V2.3                         │
├─────────────────────────────────────────────────────────────┤
│  [启动插件] [清空列表] [启动白名单] [自动保存结果]           │
│  [启用HTTP方法过滤] [启用接口路径过滤] [高级设置]           │
├─────────────────────────────────────────────────────────────┤
│  越权认证信息区域 (可拉伸)                                  │
│  参数替换配置区域 (可拉伸)                                  │
│  未授权认证信息区域 (可拉伸)                                │
├─────────────────────────────────────────────────────────────┤
│  原始数据包 | 低权限数据包 | 未授权数据包                   │
│  [请求] [响应] | [请求] [响应] | [请求] [响应]             │
└─────────────────────────────────────────────────────────────┘
```

### 表格列说明
| 列名 | 说明 | 排序支持 |
|------|------|----------|
| # | 请求ID | ✅ |
| 类型 | HTTP方法 | ✅ |
| URL | 请求地址 | ✅ |
| 原始包长度 | 原始响应长度 | ✅ |
| 低权限包长度 | 低权限响应长度 | ✅ |
| 未授权包长度 | 无权限响应长度 | ✅ |

## 🚀 使用方法

### 1. 基础配置
1. **启动插件**: 勾选"启动插件"复选框
2. **配置认证信息**: 
   - 在"越权认证信息"区域填写低权限用户的认证信息
   - 在"未授权认证信息"区域填写需要移除的认证字段
3. **配置参数替换**: 在"参数替换"区域填写替换规则

### 2. 过滤配置
1. **HTTP方法过滤**:
   - 勾选"启用HTTP方法过滤"
   - 输入要过滤的方法，用逗号分隔（如：OPTIONS,HEAD）
   - 点击"应用方法过滤"

2. **接口路径过滤**:
   - 勾选"启用接口路径过滤"
   - 输入要过滤的路径，用逗号分隔（如：/api/admin/,/admin/）
   - 点击"应用路径过滤"

3. **白名单配置**:
   - 在"白名单域名"输入框中填写域名
   - 多个域名用逗号分隔
   - 点击"启动白名单"

### 3. 右键菜单功能
- **发送到瞎越检测**: 将选中的请求发送到插件进行检测
- **提取认证信息**: 自动提取请求中的认证信息并填充到配置区域
- **快速配置**: 打开快速配置对话框，一次性配置多个参数

### 4. 数据查看
- **点击表格行**: 自动在右侧标签页显示对应的请求和响应
- **表头排序**: 点击表头可进行升序/降序排序
- **差异分析**: 通过响应长度差异快速识别越权问题

## 📋 配置参数说明

### 认证信息格式
```
# 低权限认证信息示例
Cookie: JSESSIONID=test;UUID=1; userid=admin
Authorization: Bearer test_token
X-User-Id: 12345

# 未授权认证字段示例
Cookie
Authorization
Token
X-User-Id
```

### 参数替换规则
```
# 格式：参数名=新值
project_id=123123
user_id=999
token=new_token_value
```

### 过滤配置示例
```
# HTTP方法过滤
OPTIONS,HEAD,TRACE

# 接口路径过滤
/api/admin/,/admin/,/user/profile/
```

## 🔧 高级设置

### 性能配置
- **最大日志条目数**: 限制内存中的日志数量
- **启用详细日志**: 控制日志输出详细程度
- **输出格式**: 支持TEXT、JSON、CSV格式
- **自动清理**: 自动清理旧数据

### 自定义配置
- **静态资源过滤**: 自动过滤常见静态文件扩展名
- **请求去重**: 基于智能MD5算法的请求去重
- **响应验证**: 自动验证响应有效性，跳过空响应

## 🚨 注意事项

### 使用建议
1. **合理配置过滤规则**: 避免过滤过多请求，影响检测覆盖率
2. **定期清理数据**: 长时间使用后建议清理历史数据
3. **备份配置**: 重要配置建议定期备份
4. **权限测试**: 确保测试环境的安全性，避免影响生产系统

### 兼容性说明
- 支持Burp Suite Professional 2020.1及以上版本
- 需要Java 8或更高版本
- 建议在测试环境中使用

### 性能考虑
- 大量请求时建议启用过滤功能
- 定期清理日志数据以释放内存
- 避免在性能敏感的环境中使用

## 🆕 更新日志

### v2.3 (当前版本)
- ✨ 新增参数替换功能，支持GET和POST请求
- 🎨 优化UI界面，支持输入框拉伸
- ⚡ 性能优化，移除冗余日志输出
- 🔧 修复配置加载和UI同步问题

### v2.2
- 🔍 新增HTTP方法和接口路径过滤
- 📊 实现表格排序功能
- 💾 完善配置持久化机制
- 🚀 性能优化和代码重构

### v2.1
- 🎯 核心越权检测功能
- 🔐 基础认证信息管理
- 📋 数据表格展示
- 🛠️ 右键菜单功能

## 🤝 技术支持

如果您在使用过程中遇到问题或有改进建议，欢迎反馈：

- **问题反馈**: 请详细描述问题现象和复现步骤
- **功能建议**: 欢迎提出新功能需求
- **Bug报告**: 请提供错误日志和系统环境信息

## 📄 许可证

本插件仅供安全测试和授权渗透测试使用，请遵守相关法律法规，不得用于非法用途。

---

**xiaYue_Pro** - 让越权检测更简单、更高效！ 🚀
